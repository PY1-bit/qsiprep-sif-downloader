name: Download QSIPrep SIF from GitHub Release

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'QSIPrep 版本号（对应 Release 附件）'
        required: true
        default: '0.19.1'   # 目前 Release 里带 .sif 的最新版

jobs:
  download:
    runs-on: ubuntu-latest
    steps:
      - name: 下载 Release 附件
        run: |
          wget -c \
            https://github.com/PennLINC/qsiprep/releases/download/${{ github.event.inputs.version }}/qsiprep-${{ github.event.inputs.version }}.sif \
            -O qsiprep-${{ github.event.inputs.version }}.sif
          ls -lh qsiprep-${{ github.event.inputs.version }}.sif

      - name: 上传到当前仓库的 Release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: qsiprep-${{ github.event.inputs.version }}-sif
          name: QSIPrep ${{ github.event.inputs.version }} SIF
          files: qsiprep-${{ github.event.inputs.version }}.sif
          token: ${{ secrets.GITHUB_TOKEN }}
